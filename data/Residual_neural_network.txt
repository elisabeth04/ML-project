a residual neural network (resnet) is an artificial neural network (ann). residual neural networks utilize skip connections, or shortcuts to jump over some layers. typical resnet models are implemented with double- or triple- layer skips that contain nonlinearities (relu) and batch normalization in between. an additional weight matrix may be used to learn the skip weights; these models are known as highwaynets. models with several parallel skips are referred to as densenets. in the context of residual neural networks, a non-residual network may be described as a plain network.

there are two main reasons to add skip connections: to avoid the problem of vanishing gradients, or to mitigate the degradation (accuracy saturation) problem; where adding more layers to a suitably deep model leads to higher training error. during training, the weights adapt to mute the upstream layer, and amplify the previously-skipped layer. in the simplest case, only the weights for the adjacent layer's connection are adapted, with no explicit weights for the upstream layer. this works best when a single nonlinear layer is stepped over, or when the intermediate layers are all linear. if not, then an explicit weight matrix should be learned for the skipped connection (a highwaynet should be used).
skipping effectively simplifies the network, using fewer layers in the initial training stages. this speeds learning by reducing the impact of vanishing gradients, as there are fewer layers to propagate through. the network then gradually restores the skipped layers as it learns the feature space. towards the end of training, when all layers are expanded, it stays closer to the manifold and thus learns faster. a neural network without residual parts explores more of the feature space. this makes it more vulnerable to perturbations that cause it to leave the manifold, and necessitates extra training data to recover.


== forward propagation ==
given a weight matrix 
  
    
      
        
          w
          
            ℓ
            −
            1
            ,
            ℓ
          
        
      
    
    {\textstyle w^{\ell -1,\ell }}
   for connection weights from layer 
  
    
      
        ℓ
        −
        1
      
    
    {\textstyle \ell -1}
   to 
  
    
      
        ℓ
      
    
    {\textstyle \ell }
  , and a weight matrix 
  
    
      
        
          w
          
            ℓ
            −
            2
            ,
            ℓ
          
        
      
    
    {\textstyle w^{\ell -2,\ell }}
   for connection weights from layer 
  
    
      
        ℓ
        −
        2
      
    
    {\textstyle \ell -2}
   to 
  
    
      
        ℓ
      
    
    {\textstyle \ell }
  , then the forward propagation through the activation function would be (aka highwaynets)

  
    
      
        
          
            
              
                
                  a
                  
                    ℓ
                  
                
              
              
                
                :=
                
                  g
                
                (
                
                  w
                  
                    ℓ
                    −
                    1
                    ,
                    ℓ
                  
                
                ⋅
                
                  a
                  
                    ℓ
                    −
                    1
                  
                
                +
                
                  b
                  
                    ℓ
                  
                
                +
                
                  w
                  
                    ℓ
                    −
                    2
                    ,
                    ℓ
                  
                
                ⋅
                
                  a
                  
                    ℓ
                    −
                    2
                  
                
                )
              
            
            
              
              
                
                :=
                
                  g
                
                (
                
                  z
                  
                    ℓ
                  
                
                +
                
                  w
                  
                    ℓ
                    −
                    2
                    ,
                    ℓ
                  
                
                ⋅
                
                  a
                  
                    ℓ
                    −
                    2
                  
                
                )
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}a^{\ell }&:=\mathbf {g} (w^{\ell -1,\ell }\cdot a^{\ell -1}+b^{\ell }+w^{\ell -2,\ell }\cdot a^{\ell -2})\\&:=\mathbf {g} (z^{\ell }+w^{\ell -2,\ell }\cdot a^{\ell -2})\end{aligned}}}
  where 

  
    
      
        
          a
          
            ℓ
          
        
      
    
    {\textstyle a^{\ell }}
   the activations (outputs) of neurons in layer 
  
    
      
        ℓ
      
    
    {\textstyle \ell }
  ,

  
    
      
        
          g
        
      
    
    {\textstyle \mathbf {g} }
   the activation function for layer 
  
    
      
        ℓ
      
    
    {\textstyle \ell }
  ,

  
    
      
        
          w
          
            ℓ
            −
            1
            ,
            ℓ
          
        
      
    
    {\textstyle w^{\ell -1,\ell }}
   the weight matrix for neurons between layer 
  
    
      
        ℓ
        −
        1
      
    
    {\textstyle \ell -1}
   and 
  
    
      
        ℓ
      
    
    {\textstyle \ell }
  , and

  
    
      
        
          z
          
            ℓ
          
        
        =
        
          w
          
            ℓ
            −
            1
            ,
            ℓ
          
        
        ⋅
        
          a
          
            ℓ
            −
            1
          
        
        +
        
          b
          
            ℓ
          
        
      
    
    {\textstyle z^{\ell }=w^{\ell -1,\ell }\cdot a^{\ell -1}+b^{\ell }}
  absent an explicit matrix 
  
    
      
        
          w
          
            ℓ
            −
            2
            ,
            ℓ
          
        
      
    
    {\textstyle w^{\ell -2,\ell }}
   (aka resnets), forward propagation through the activation function simplifies to

  
    
      
        
          a
          
            ℓ
          
        
        :=
        
          g
        
        (
        
          z
          
            ℓ
          
        
        +
        
          a
          
            ℓ
            −
            2
          
        
        )
      
    
    {\displaystyle a^{\ell }:=\mathbf {g} (z^{\ell }+a^{\ell -2})}
  another way to formulate this is to substitute an identity matrix for 
  
    
      
        
          w
          
            ℓ
            −
            2
            ,
            ℓ
          
        
      
    
    {\textstyle w^{\ell -2,\ell }}
  , but that is only valid when the dimensions match. this is somewhat confusingly called an identity block, which means that the activations from layer 
  
    
      
        ℓ
        −
        2
      
    
    {\textstyle \ell -2}
   are passed to layer 
  
    
      
        ℓ
      
    
    {\textstyle \ell }
   without weighting.
in the cerebral cortex such forward skips are done for several layers. usually all forward skips start from the same layer, and successively connect to later layers. in the general case this will be expressed as (aka densenets)

  
    
      
        
          a
          
            ℓ
          
        
        :=
        
          g
        
        
          (
          
            
              z
              
                ℓ
              
            
            +
            
              ∑
              
                k
                =
                2
              
              
                k
              
            
            
              w
              
                ℓ
                −
                k
                ,
                ℓ
              
            
            ⋅
            
              a
              
                ℓ
                −
                k
              
            
          
          )
        
      
    
    {\displaystyle a^{\ell }:=\mathbf {g} \left(z^{\ell }+\sum _{k=2}^{k}w^{\ell -k,\ell }\cdot a^{\ell -k}\right)}
  .


== backward propagation ==
during backpropagation learning for the normal path

  
    
      
        δ
        
          w
          
            ℓ
            −
            1
            ,
            ℓ
          
        
        :=
        −
        η
        
          
            
              ∂
              
                e
                
                  ℓ
                
              
            
            
              ∂
              
                w
                
                  ℓ
                  −
                  1
                  ,
                  ℓ
                
              
            
          
        
        =
        −
        η
        
          a
          
            ℓ
            −
            1
          
        
        ⋅
        
          δ
          
            ℓ
          
        
      
    
    {\displaystyle \delta w^{\ell -1,\ell }:=-\eta {\frac {\partial e^{\ell }}{\partial w^{\ell -1,\ell }}}=-\eta a^{\ell -1}\cdot \delta ^{\ell }}
  and for the skip paths (nearly identical)

  
    
      
        δ
        
          w
          
            ℓ
            −
            2
            ,
            ℓ
          
        
        :=
        −
        η
        
          
            
              ∂
              
                e
                
                  ℓ
                
              
            
            
              ∂
              
                w
                
                  ℓ
                  −
                  2
                  ,
                  ℓ
                
              
            
          
        
        =
        −
        η
        
          a
          
            ℓ
            −
            2
          
        
        ⋅
        
          δ
          
            ℓ
          
        
      
    
    {\displaystyle \delta w^{\ell -2,\ell }:=-\eta {\frac {\partial e^{\ell }}{\partial w^{\ell -2,\ell }}}=-\eta a^{\ell -2}\cdot \delta ^{\ell }}
  .in both cases 

  
    
      
        η
      
    
    {\textstyle \eta }
   a learning rate (
  
    
      
        η
        <
        0
        )
      
    
    {\textstyle \eta <0)}
  ,

  
    
      
        
          δ
          
            ℓ
          
        
      
    
    {\textstyle \delta ^{\ell }}
   the error signal of neurons at layer 
  
    
      
        ℓ
      
    
    {\textstyle \ell }
  , and

  
    
      
        
          a
          
            i
          
          
            ℓ
          
        
      
    
    {\textstyle a_{i}^{\ell }}
   the activation of neurons at layer 
  
    
      
        ℓ
      
    
    {\textstyle \ell }
  .if the skip path has fixed weights (e.g. the identity matrix, as above), then they are not updated. if they can be updated, the rule is an ordinary backpropagation update rule.
in the general case there can be 
  
    
      
        k
      
    
    {\textstyle k}
   skip path weight matrices, thus

  
    
      
        δ
        
          w
          
            ℓ
            −
            k
            ,
            ℓ
          
        
        :=
        −
        η
        
          
            
              ∂
              
                e
                
                  ℓ
                
              
            
            
              ∂
              
                w
                
                  ℓ
                  −
                  k
                  ,
                  ℓ
                
              
            
          
        
        =
        −
        η
        
          a
          
            ℓ
            −
            k
          
        
        ⋅
        
          δ
          
            ℓ
          
        
      
    
    {\displaystyle \delta w^{\ell -k,\ell }:=-\eta {\frac {\partial e^{\ell }}{\partial w^{\ell -k,\ell }}}=-\eta a^{\ell -k}\cdot \delta ^{\ell }}
  as the learning rules are similar, the weight matrices can be merged and learned in the same step.


== references ==